import { Callout, Steps, Step } from "nextra-theme-docs";

# IPAMM

The **IPAMM** (Primary Automated Market Maker) is the core contract responsible for the pricing mechanism of the Gyroscope protocol. It defines the core functions and parameters that govern the minting and redemption of Gyro dollars (GYD) tokens.

The IPAMM interface provides the following key functionalities:

1. **Mint GYD**: Allows users to mint GYD tokens by depositing assets into the protocol. The amount of GYD minted is determined by the current state of the reserve and the system parameters.

2. **Redeem GYD**: Allows users to redeem their GYD tokens in exchange for the underlying assets. The amount of assets received is also determined by the current state of the reserve and the system parameters.

3. **Update System Parameters**: Provides a way for the protocol governance to update the key system parameters that control the pricing and behavior of the PAMM.

Let's dive into the details of these functionalities:

## Minting GYD

The `computeMintAmount` function is used to quote the amount of GYD that will be minted for a given USD amount. This function takes the following parameters:

- `usdAmount`: The amount of USD to be used to mint GYD.
- `reserveUSDValue`: The current USD value of the reserve.

The function returns the amount of GYD that will be minted for the provided `usdAmount`. This calculation is based on the current state of the reserve and the system parameters defined in the PAMM contract.

The actual minting of GYD is performed by the `mint` function, which records the minting operation and returns the minted GYD amount. This function is typically called by the [IMotherboard](/core-contracts/imotherboard) contract, which is the central entry point for interacting with the Gyroscope protocol.

<Callout type="info">
The minting process involves updating the reserve state, such as the redemption level and the total GYD supply. These updates are handled within the PAMM contract to ensure the integrity of the protocol's pricing mechanism.
</Callout>

## Redeeming GYD

The `computeRedeemAmount` function is used to quote the amount of underlying assets that will be received when redeeming a given amount of GYD tokens. This function takes the following parameters:

- `gydAmount`: The amount of GYD tokens to be redeemed.
- `reserveUSDValue`: The current USD value of the reserve.

The function returns the amount of underlying assets that will be received for the provided `gydAmount`. This calculation is based on the current state of the reserve and the system parameters defined in the PAMM contract.

The actual redemption of GYD is performed by the `redeem` function, which records the redemption operation and returns the redeemed asset amount. This function is typically called by the [IMotherboard](/core-contracts/imotherboard) contract, which is the central entry point for interacting with the Gyroscope protocol.

<Callout type="info">
The redemption process involves updating the reserve state, such as the redemption level and the total GYD supply. These updates are handled within the PAMM contract to ensure the integrity of the protocol's pricing mechanism.
</Callout>

## Updating System Parameters

The `setSystemParams` function allows the protocol governance to update the key system parameters that control the pricing and behavior of the PAMM. These parameters include:

- `alphaBar`: The maximum alpha value for the PAMM.
- `xuBar`: The maximum xu value for the PAMM.
- `thetaBar`: The maximum theta value for the PAMM.
- `outflowMemory`: The outflow memory parameter used in the flow calculation.

Updating these parameters can have a significant impact on the protocol's pricing and behavior, so it is important that any changes are carefully considered and approved by the protocol governance.

<Callout type="warning">
Changing the system parameters can affect the behavior of the minting and redemption processes, so it is important to thoroughly test and analyze the impact of any parameter updates before deploying them to the live protocol.
</Callout>

The IPAMM interface is a critical component of the Gyroscope protocol, as it defines the core pricing mechanism that ensures the stability and value of the GYD token. By understanding the functionality of this interface, developers can build applications and integrations that leverage the Gyroscope protocol's minting and redemption capabilities.